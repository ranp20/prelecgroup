$(() =>{
  var locationsGET = window.location.href;
  // var csrfTokenFrm = $(".subscriber-form").find("input[name='_token']").val();
  var csrfTokenFrm = $("#stripe").find("input[name='_token']").val();
  // ------------ FORMATO - SEPARADOR DE NÚMERO TELEFÓNICO(+51)
  $(document).on("input keyup keypress", "input[data-valformat=withspacesforthreenumbers]", function(e){
    let val = e.target.value;
    if($(this).attr("maxlength") <= 9){
      $(this).val(val.replace(/\D+/g, '').replace(/(\d{3})(\d{3})(\d{3})/, '$1 $2 $3'));
    }
  });
  // ------------ FORMATO - SOLO NÚMEROS ENTEROS POSITIVOS
  (function($){
    $.fn.inputFilter = function(callback, errMsg){
      return this.on("input keydown keyup mousedown mouseup select contextmenu drop focusout", function(e){
        if(callback(this.value)){
          // Accepted value
          if(["keydown","mousedown","focusout"].indexOf(e.type) >= 0){
            $(this).removeClass("input-error");
            $("#spn-fgTchkMdl23_transaction").text("");
            this.setCustomValidity("");
          }
          this.oldValue = this.value;
          this.oldSelectionStart = this.selectionStart;
          this.oldSelectionEnd = this.selectionEnd;
          // console.log($(this).length);
        } else if(this.hasOwnProperty("oldValue")){
          // Rejected value - restore the previous one
          $(this).addClass("input-error");
          $("#spn-fgTchkMdl23_transaction").text("Solo se permiten números*");
          this.setCustomValidity(errMsg);
          this.reportValidity();
          this.value = this.oldValue;
          this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);
        } else{
          // Rejected value - nothing to restore
          this.value = "";
        }
      });
    };
  }(jQuery));
  $(document).ready(function(){
    $("input[data-valformat=onlyintegers]").inputFilter(function(value){
      return /^\d*$/.test(value); // Permitir solo dígitos, usando RegExp
    },"Solo se permiten números");
  });
  // ------------ FORMATO - SÓLO DÍGITOS PARA LOS ELEMENTOS CREADOS DESPUÉS DE CARGADO EL DOM
  $(document).on("input keyup keypress","input[data-valformat=onlydigits]", function(){
    $(this).val($(this).val().replace(/[^0-9]/g, ''));
  });
  // ------------ LISTAR VALORES DEL LOGIN/REGISTER
  $(document).on("change", "#reg-slOpts__voucher", function(e){
    let optSel = $(this).val();

    e.preventDefault();
    let optSelected = $("#reg-slOpts__voucher option:selected").val();
    let optValIdFormValid = (optSelected != "" && optSelected != 0 && optSelected == 1) ? 'boleta' : 'factura';
    let dataHrefURLVoucher = $(this).data("href");
    var inputValue = $(this).find("input[type=text]");
    // let jsonDataVoucher = [];
    var formdataX = new FormData();
    formdataX.append("chckpay_selOpt", optValIdFormValid);
    $.each(inputValue, function(i,e){
      let inputDataName = $(this).attr('name');
      let inputDataValue = $(this).val();
      formdataX.append(inputDataName, inputDataValue);
    });
    requestSent = true;
    if(optSel == 1){
      $.ajax({
        headers: {
          'X-CSRF-TOKEN': csrfTokenFrm
        },
        url: dataHrefURLVoucher,
        data: formdataX,
        type: "POST",
        processData: false,
        contentType: false,
        beforeSend: function(){
          
        },
        success: function(e){
          let r = e;
          var tmpFor = ``;
          // console.log(e);
          
          if(e.selOptSelectedId == 1){
            $("#sl-docopts_conts").html(`
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-firt_name">Nombres</label>
                  <input class="form-control" name="chckpay_firt_name" type="text" id="chckpay-firt_name" value="" placeholder="Nombres" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-dni">DNI</label>
                  <input class="form-control" name="chckpay_dni" type="text" id="chckpay-dni" value="" placeholder="DNI" data-valformat="onlydigits" maxlength="8" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" id="chckpay-phone" value="" placeholder="Teléfono" data-valformat="withspacesforthreenumbers" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          `);
          }else if(e.selOptSelectedId == 2){
            $("#sl-docopts_conts").html(`
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-ruc">RUC</label>
                  <input class="form-control" name="chckpay_ruc" type="text" data-valformat="onlydigits" id="chckpay-ruc" value="${r.ruc}" placeholder="RUC" maxlength="11" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-razonsocial">Razón Social</label>
                  <input class="form-control" name="chckpay_razonsocial" type="text" id="chckpay-razonsocial" value="${r.razonsocial}" placeholder="Razón Social" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-address">Dirección</label>
                  <input class="form-control" name="chckpay_address" type="text" id="chckpay-address" value="${r.address}" placeholder="Dirección" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" data-valformat="withspacesforthreenumbers" id="chckpay-phone" value="${r.phone}" placeholder="Teléfono" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span>
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
            `);
          }else{
            $("#sl-docopts_conts").html("");
            $("#dkdr__fL236-ctPayMthd-s").html("");
          }
  
        },
        complete: function(){
          requestSent = false;
        }
      });
      return false;
    }else if(optSel == 2){
      $.ajax({
        headers: {
          'X-CSRF-TOKEN': csrfTokenFrm
        },
        url: dataHrefURLVoucher,
        data: formdataX,
        type: "POST",
        processData: false,
        contentType: false,
        beforeSend: function(){
          
        },
        success: function(e){
          let r = e;
          var tmpFor = ``;
          // console.log(e);
          
          if(e.selOptSelectedId == 1){
            $("#sl-docopts_conts").html(`
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-firt_name">Nombres</label>
                  <input class="form-control" name="chckpay_firt_name" type="text" id="chckpay-firt_name" value="" placeholder="Nombres" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-dni">DNI</label>
                  <input class="form-control" name="chckpay_dni" type="text" id="chckpay-dni" value="" placeholder="DNI" data-valformat="onlydigits" maxlength="8" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" id="chckpay-phone" value="" placeholder="Teléfono" data-valformat="withspacesforthreenumbers" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          `);
          }else if(e.selOptSelectedId == 2){
            $("#sl-docopts_conts").html(`
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-ruc">RUC</label>
                  <input class="form-control" name="chckpay_ruc" type="text" data-valformat="onlydigits" id="chckpay-ruc" value="${r.ruc}" placeholder="RUC" maxlength="11" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-razonsocial">Razón Social</label>
                  <input class="form-control" name="chckpay_razonsocial" type="text" id="chckpay-razonsocial" value="${r.razonsocial}" placeholder="Razón Social" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-address">Dirección</label>
                  <input class="form-control" name="chckpay_address" type="text" id="chckpay-address" value="${r.address}" placeholder="Dirección" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" data-valformat="withspacesforthreenumbers" id="chckpay-phone" value="${r.phone}" placeholder="Teléfono" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span>
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
            `);
          }else{
            $("#sl-docopts_conts").html("");
            $("#dkdr__fL236-ctPayMthd-s").html("");
          }
  
        },
        complete: function(){
          requestSent = false;
        }
      });
      return false;
    }else{
      $("#sl-docopts_conts").html("");
      $("#dkdr__fL236-ctPayMthd-s").html("");
    }    

  });
  $(document).on("click","#cTentr-af1698__1prevChckp",function(e){
    e.preventDefault();
    let dataHrefURL = $(this).data("href");

    var optionsPDFObject ={
      fallbackLink: "<p>Este navegador no admite archivos PDF en línea. Por favor descargue el PDF para verlo: <a href='[url]'>Descargar PDF</a></p>",
      width: "100%",
      height: "100%",
      omitInlineStyles: true,
      id: "myPDFIdOrder",
      pdfOpenParams:{
        view: 'FitV'
      }
    };

    $.ajax({
      headers:{
        'X-CSRF-TOKEN': csrfTokenFrm
      },
      type: 'POST',
      url: dataHrefURL,
      xhrFields:{
        responseType: 'blob'
      },
      beforeSend: function(){
        $("#cTentr-af1698__1prevChckp-show").html(`
        <div class="d-flex align-items-center justify-content-center mx-auto py-5 h-100" style="max-width: 60px;width:60px;height:60px;">
          <img src="../../assets/images/Utilities/loader.gif" alt="icon-update" width="100" height="100" decoding="sync">
        </div>
        `);  
      },
      success: function(blob, status, xhr){
        
        var filename = "";
        var disposition = xhr.getResponseHeader('Content-Disposition');
        if(disposition && disposition.indexOf('attachment') !== -1){
          var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
          var matches = filenameRegex.exec(disposition);
          if(matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
        }

        if(typeof window.navigator.msSaveBlob !== 'undefined'){
          window.navigator.msSaveBlob(blob, filename);
        }else{
          var URL = window.URL || window.webkitURL;
          var downloadUrl = URL.createObjectURL(blob);
          /*
          var blobNameObject = new Blob([filename],{type: 'application/pdf'});
          var urlNewName = window.URL.createObjectURL(blobNameObject);
          */
          /*
          var blob = blob.slice(0, blob.size, blob.type);
          var newFile = new File([blob], 'oiaisdsadsad.pdf',{type: 'application/pdf'});
          console.log("asdasdasd"+newFile);
          */
          let a = $("#cTentr-af1698__1prevChckpPDFDown");
          a.attr('href', downloadUrl);
          a.attr('download', 'previsualizacion_del_pedido.pdf');
          if(filename){            
            PDFObject.embed(downloadUrl, "#cTentr-af1698__1prevChckp-show", optionsPDFObject);
          }else{
            PDFObject.embed(downloadUrl, "#cTentr-af1698__1prevChckp-show", optionsPDFObject);
          }
          PDFObject.embed(downloadUrl, "#cTentr-af1698__1prevChckp-show", optionsPDFObject);
        }       
      }
    });
  });
  // --------- VALIDACIÓN DE DATOS "COMPROBANTE DE PAGO"
  var requestSent = false;
  $(document).on("submit","form#dft443__gH09-checkoutvoucher", function(e){
    e.preventDefault();
    let optSelected = $("#reg-slOpts__voucher option:selected").val();
    let optValIdFormValid = (optSelected != "" && optSelected != 0 && optSelected == 1) ? 'boleta' : 'factura';
    let dataHrefURLVoucher = $(this).data("href");
    var inputValue = $(this).find("input[type=text]");
    // let jsonDataVoucher = [];
    var formdataX = new FormData();
    formdataX.append("chckpay_selOpt", optValIdFormValid);
    $.each(inputValue, function(i,e){
      let inputDataName = $(this).attr('name');
      let inputDataValue = $(this).val();
      formdataX.append(inputDataName, inputDataValue);
    });
    requestSent = true;
    $.ajax({
      headers: {
        'X-CSRF-TOKEN': csrfTokenFrm
      },
      url: dataHrefURLVoucher,
      data: formdataX,
      type: "POST",
      processData: false,
      contentType: false,
      beforeSend: function(){
        $("#sl-docopts_conts").html(`
        <div class="d-flex align-items-center justify-content-center mx-auto py-5" style="max-width: 60px;width:60px;height:60px;">
          <img src="../../assets/images/Utilities/loader.gif" alt="icon-update" width="100" height="100" decoding="sync">
        </div>
        `);
      },
      success: function(e){
        let r = e;
        var tmpFor = ``;
        // console.log(e);
        if(e.selOptSelectedId == 1){
          tmpFor = `
          <div class="cBillgADtls">
            <div class="cBillgADtls__c">
              <div class="cBillgADtls__c__i">
                <p><span><strong>Nombres: </strong></span><span>${r.first_name}</span></p>
              </div>
              <div class="cBillgADtls__c__i">
                <p><span><strong>DNI: </strong></span><span>${r.dni}</span></p>
              </div>
              <div class="cBillgADtls__c__i">
                <span><strong>Teléfono: </strong></span><span><a href="tel: +51 912845235">${r.phone}</a></span>
              </div>
              <button type="button" class="btnUpdtInf-voucher">
                <span class="icon-updt">
                  <img src="../../assets/images/Utilities/icon-update.png" alt="icon-update" width="100" height="100" decoding="sync">
                </span>
                <span>Editar información</span>
              </button>
            </div>
            <div class="col-12 d-flex align-items-center justify-content-start">
              <div class="form-group mt-3 mb-0">
                <div class="btn btn-success d-flex align-items-center" t-apparence="btn-sub__frm">
                  <span>Finalizar compra</span>
                  <span class="cNxticon-i">
                    <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div data-sec="setlist" style="display: none;">
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-firt_name">Nombres</label>
                  <input class="form-control" name="chckpay_firt_name" type="text" id="chckpay-firt_name" value="${r.first_name}" placeholder="Nombres" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-dni">DNI</label>
                  <input class="form-control" name="chckpay_dni" type="text" id="chckpay-dni" value="${r.dni}" placeholder="DNI" data-valformat="onlydigits" maxlength="8" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" id="chckpay-phone" value="${r.phone}" placeholder="Teléfono" data-valformat="withspacesforthreenumbers" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          `;
        }else if(e.selOptSelectedId == 2){
          tmpFor = `
          <div class="cBillgADtls">
            <div class="cBillgADtls__c">
              <div class="cBillgADtls__c__i">
                <p><span><strong>RUC - Reg unico contribuyente: </strong></span><span>${r.ruc}</span></p>
              </div>
              <div class="cBillgADtls__c__i">
                <p><span><strong>Razon social: </strong></span><span>${r.razonsocial}</span></p>
              </div>
              <div class="cBillgADtls__c__i">
                <p><span><strong>Dirección: </strong></span><span>${r.address}</span></p>
              </div>
              <div class="cBillgADtls__c__i">
                <span><strong>Teléfono: </strong></span><span><a href="tel: +51 912845235">${r.phone}</a></span>
              </div>
              <button type="button" class="btnUpdtInf-voucher">
                <span class="icon-updt">
                  <img src="../../assets/images/Utilities/icon-update.png" alt="icon-update" width="100" height="100" decoding="sync">
                </span>
                <span>Editar información</span>
              </button>
            </div>
            <div class="col-12 d-flex align-items-center justify-content-start">
              <div class="form-group mt-3 mb-0">
                <div class="btn btn-success d-flex align-items-center" t-apparence="btn-sub__frm">
                  <span>Finalizar compra</span>
                  <span class="cNxticon-i">
                    <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div data-sec="setlist" style="display: none;">
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-ruc">RUC</label>
                  <input class="form-control" name="chckpay_ruc" type="text" data-valformat="onlydigits" id="chckpay-ruc" value="${r.ruc}" placeholder="RUC" maxlength="11" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-razonsocial">Razón Social</label>
                  <input class="form-control" name="chckpay_razonsocial" type="text" id="chckpay-razonsocial" value="${r.razonsocial}" placeholder="Razón Social" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-address">Dirección</label>
                  <input class="form-control" name="chckpay_address" type="text" id="chckpay-address" value="${r.address}" placeholder="Dirección" required>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="chckpay-phone">Teléfono</label>
                  <input class="form-control" name="chckpay_phone" type="text" data-valformat="withspacesforthreenumbers" id="chckpay-phone" value="${r.phone}" placeholder="Teléfono" maxlength="9" required>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <button type="submit" class="btn btn-primary d-flex align-items-center">
                    <span>Confirmar Datos</span>
                    <span>
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </button>
                </div>
              </div>
              <div class="col-12 d-flex align-items-center justify-content-start">
                <div class="form-group">
                  <div class="btn btn-success d-flex align-items-center" disabled="disabled">
                    <span>Finalizar compra</span>
                    <span class="cNxticon-i">
                      <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"/><g i:extraneous="self"><path d="M95.9,46.2L65.4,15.7c-2.1-2.1-5.5-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l21.5,21.5H7.8c-2.9,0-5.3,2.4-5.3,5.3    c0,2.9,2.4,5.3,5.3,5.3h71.5L57.9,76.8c-2.1,2.1-2.1,5.5,0,7.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l30.6-30.6    c1-1,1.6-2.4,1.6-3.8C97.5,48.6,96.9,47.2,95.9,46.2z"/></g></switch></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          `;
        }else{
          tmpFor = ``;
        }
        $("#sl-docopts_conts").html(tmpFor);
      },
      complete: function(){
        requestSent = false;
      }
    });
    return false;
    
  });
  // --------- VISUALIZAR LOS DATOS INGRESADOS
  $(document).on("click",".btnUpdtInf-voucher",function(){
    $(this).parent().parent().parent().find("div[data-sec=setlist]").addClass("show_d43gHa-sd");
    $(this).parent().parent().remove();
  });
  // --------- MOSTRAR LOS MÉTODOS DE PAGO (PROVICIONAL)
  $(document).on("click","div[t-apparence=btn-sub__frm]",function(){
    // console.log("adsasd");
    // let csrfTokenFrmupdate = $("#token_update").val();
    // let dataHrefURLVoucher = $(this).data("href");
    // $.ajax({
    //   headers: {
    //     'X-CSRF-TOKEN': csrfTokenFrmupdate
    //   },
    //   url: dataHrefURLVoucher,
    //   // data: formdataX,
    //   type: "POST",
    //   processData: false,
    //   contentType: false,
    //   beforeSend: function(){
    //     // console.log(e);
    //   },
    //   success: function(e){
    //     console.log(e);
    //   },
    //   complete: function(){
    //     requestSent = false;
    //   }
    // });
    $("#dkdr__fL236-ctPayMthd-s").css({"display":"none"});
    $("#dkdr__fL236-ctPayMthd-s").addClass('card-listenevent');
    $(`
      <div class="d-flex align-items-center justify-content-center mx-auto py-5 prchargeloader" style="max-width: 60px;width:60px;height:60px;">
        <img src="../../assets/images/Utilities/loader.gif" alt="icon-update" width="100" height="100" decoding="sync">
      </div>
    `).insertBefore("#dkdr__fL236-ctPayMthd-s");
    setTimeout(function(){
      $("#dkdr__fL236-ctPayMthd-s").prev().remove();
      $("#dkdr__fL236-ctPayMthd-s").removeClass('card-listenevent');
      $("#dkdr__fL236-ctPayMthd-s").css({"display":"block"});
    }, 500);
  });
});